<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Viagens - F√©rias</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

body {
  font-family: 'Roboto', sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(to bottom, #87CEFA, #ffffff);
  color: #333;
}

header {
  text-align: center;
  background: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1350&q=80') no-repeat center;
  background-size: cover;
  padding: 40px 0;
  color: #fff;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
}

header h1 { font-size: 2.5em; margin: 0; }

table {
  width: 95%;
  border-collapse: collapse;
  margin: 20px auto;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 6px 18px rgba(0,0,0,0.15);
  background-color: rgba(255,255,255,0.95);
}

th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ccc; }
th.hospedagem, td.hospedagem { width: 180px; }
th.allInclusive, td.allInclusive { width: 80px; text-align: center; }

tr:hover { background-color: rgba(0, 128, 128, 0.1); }
.mais-barato { background-color: #d4edda !important; }

input, select {
  padding: 8px;
  width: 90%;
  margin: 5px 0;
  border-radius: 6px;
  border: 1px solid #ccc;
  box-shadow: 1px 1px 4px rgba(0,0,0,0.1);
}

button {
  padding: 6px 12px;
  margin-top: 5px;
  cursor: pointer;
  border: none;
  border-radius: 8px;
  background-color: #ff7f50;
  color: #fff;
  font-weight: bold;
  transition: transform 0.2s, background-color 0.3s;
}

button:hover {
  background-color: #ff6347;
  transform: scale(1.05);
}

#resumo { margin-top: 15px; text-align: center; font-weight: bold; font-size: 1.2em; color: #2E8B57; }
#ordenarBtn { display: block; margin: 10px auto; }
h2 { text-align: center; color: #2E8B57; }
a { text-decoration: none; color: #fff; }
</style>
</head>
<body>

<header>
  <h1>‚úàÔ∏èüå¥üèñÔ∏è Sistema de Viagens - F√©rias üå¥‚úàÔ∏èüèñÔ∏è</h1>
</header>

<label style="text-align:center; display:block;">Filtrar por m√™s:</label>
<select id="filtroMes" style="width: 200px; margin: 0 auto; display: block;">
  <option value="">Todos</option>
  <option value="Janeiro">Janeiro</option>
  <option value="Fevereiro">Fevereiro</option>
  <option value="Mar√ßo">Mar√ßo</option>
  <option value="Abril">Abril</option>
  <option value="Maio">Maio</option>
  <option value="Junho">Junho</option>
  <option value="Julho">Julho</option>
  <option value="Agosto">Agosto</option>
  <option value="Setembro">Setembro</option>
  <option value="Outubro">Outubro</option>
  <option value="Novembro">Novembro</option>
  <option value="Dezembro">Dezembro</option>
</select>

<button id="ordenarBtn">Ordenar do Mais Barato para o Mais Caro</button>

<table id="viagensTable">
<thead>
<tr>
  <th>Destino</th>
  <th class="hospedagem">Hospedagem</th>
  <th>Tipo</th>
  <th class="allInclusive">All Inclusive</th>
  <th>Valor do Hotel (R$)</th>
  <th>Valor da Passagem (R$)</th>
  <th>Pessoas</th>
  <th>Total Base (R$)</th>
  <th>M√™s</th>
  <th>Ano</th>
  <th>A√ß√µes</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div id="resumo"></div>

<h2>Adicionar / Editar Viagem</h2>
<form id="viagemForm">
  <input type="hidden" id="editId">
  <input type="text" id="destino" placeholder="Destino" required><br>
  <input type="text" id="hotel" placeholder="Nome da Hospedagem" required><br>
  <input type="url" id="linkHotel" placeholder="Link do Hotel (URL)" required><br>

  <select id="tipoHospedagem" required>
    <option value="Hotel">Hotel</option>
    <option value="Airbnb">Airbnb</option>
  </select><br>

  <select id="allInclusive" required>
    <option value="Sim">All Inclusive</option>
    <option value="N√£o">N√£o</option>
  </select><br>

  <input type="number" id="valorHotel" placeholder="Valor do Hotel" required><br>
  <input type="number" id="valorPassagem" placeholder="Valor da Passagem" required><br>
  <input type="number" id="pessoas" placeholder="Quantidade de Pessoas" min="1" required><br>

  <select id="mes" required>
    <option value="">Selecione o m√™s</option>
    <option value="Janeiro">Janeiro</option>
    <option value="Fevereiro">Fevereiro</option>
    <option value="Mar√ßo">Mar√ßo</option>
    <option value="Abril">Abril</option>
    <option value="Maio">Maio</option>
    <option value="Junho">Junho</option>
    <option value="Julho">Julho</option>
    <option value="Agosto">Agosto</option>
    <option value="Setembro">Setembro</option>
    <option value="Outubro">Outubro</option>
    <option value="Novembro">Novembro</option>
    <option value="Dezembro">Dezembro</option>
  </select><br>

  <input type="number" id="ano" placeholder="Ano da Viagem" required><br>
  <button type="submit">Salvar Viagem</button>
</form>

<script>
  // Configura√ß√£o do Firebase
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_DOMINIO.firebaseapp.com",
    projectId: "SEU_PROJECT_ID",
    storageBucket: "SEU_PROJECT_ID.appspot.com",
    messagingSenderId: "SEU_SENDER_ID",
    appId: "SEU_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const form = document.getElementById('viagemForm');
  const tableBody = document.querySelector('#viagensTable tbody');
  const resumo = document.getElementById('resumo');
  const ordenarBtn = document.getElementById('ordenarBtn');
  const filtroMes = document.getElementById('filtroMes');

  function mostrarViagensNaTabela(viagens){
    if(!viagens.length){
      tableBody.innerHTML='';
      resumo.textContent="Nenhuma viagem cadastrada.";
      return;
    }

    viagens.forEach(v=>v.totalBase=parseFloat(v.valorHotel)+parseFloat(v.valorPassagem));
    const menorTotal = Math.min(...viagens.map(v=>v.totalBase));

    tableBody.innerHTML='';
    viagens.forEach(v=>{
      const row = document.createElement('tr');
      if(v.totalBase===menorTotal) row.classList.add('mais-barato');

      const iconHospedagem = v.tipoHospedagem==="Hotel"?"üè®":"üè†";
      const iconAllInclusive = v.allInclusive==="Sim"?"üçπ":"‚ùå";

      row.innerHTML=`
        <td>üå¥ ${v.destino}</td>
        <td class="hospedagem">${iconHospedagem} <button title="Abrir link do hotel" onclick="window.open('${v.linkHotel}', '_blank')">${v.hotel}</button></td>
        <td>${v.tipoHospedagem}</td>
        <td class="allInclusive">${iconAllInclusive}</td>
        <td>‚úàÔ∏è R$ ${parseFloat(v.valorHotel).toFixed(2)}</td>
        <td>‚úàÔ∏è R$ ${parseFloat(v.valorPassagem).toFixed(2)}</td>
        <td>${v.pessoas}</td>
        <td>R$ ${v.totalBase.toFixed(2)}</td>
        <td>${v.mes}</td>
        <td>${v.ano}</td>
        <td>
          <button onclick="editarViagem('${v.id}')">Editar</button>
          <button onclick="removerViagemFirebase('${v.id}')">Remover</button>
        </td>
      `;
      tableBody.appendChild(row);
    });

    const destinosBaratos = viagens.filter(v=>v.totalBase===menorTotal)
                                   .map(v=>`${v.destino} (R$ ${v.totalBase.toFixed(2)})`).join(', ');
    resumo.textContent=`Destino(s) mais barato(s): ${destinosBaratos}`;
  }

  function carregarViagensFirebase(){
    db.collection("viagens").get().then(snapshot=>{
      let viagens = [];
      snapshot.forEach(doc=>{
        viagens.push({id: doc.id, ...doc.data()});
      });
      // Aplicar filtro por m√™s
      if(filtroMes.value) viagens = viagens.filter(v=>v.mes===filtroMes.value);
      mostrarViagensNaTabela(viagens);
    });
  }

  function salvarViagemFirebase(viagem){
    db.collection("viagens").add(viagem).then(()=>carregarViagensFirebase());
  }

  function atualizarViagemFirebase(id, dados){
    db.collection("viagens").doc(id).update(dados).then(()=>carregarViagensFirebase());
  }

  function removerViagemFirebase(id){
    db.collection("viagens").doc(id).delete().then(()=>carregarViagensFirebase());
  }

  function editarViagem(id){
    db.collection("viagens").doc(id).get().then(doc=>{
      const v = doc.data();
      document.getElementById('editId').value = id;
      document.getElementById('destino').value = v.destino;
      document.getElementById('hotel').value = v.hotel;
      document.getElementById('linkHotel').value = v.linkHotel;
      document.getElementById('tipoHospedagem').value = v.tipoHospedagem;
      document.getElementById('allInclusive').value = v.allInclusive;
      document.getElementById('valorHotel').value = v.valorHotel;
      document.getElementById('valorPassagem').value = v.valorPassagem;
      document.getElementById('pessoas').value = v.pessoas;
      document.getElementById('mes').value = v.mes;
      document.getElementById('ano').value = v.ano;
    });
  }

  form.addEventListener('submit',function(e){
    e.preventDefault();
    const viagem = {
      destino: document.getElementById('destino').value,
      hotel: document.getElementById('hotel').value,
      linkHotel: document.getElementById('linkHotel').value,
      tipoHospedagem: document.getElementById('tipoHospedagem').value,
      allInclusive: document.getElementById('allInclusive').value,
      valorHotel: document.getElementById('valorHotel').value,
      valorPassagem: document.getElementById('valorPassagem').value,
      pessoas: document.getElementById('pessoas').value,
      mes: document.getElementById('mes').value,
      ano: document.getElementById('ano').value
    };

    const editId = document.getElementById('editId').value;
    if(editId){
      atualizarViagemFirebase(editId, viagem);
      document.getElementById('editId').value = '';
    } else {
      salvarViagemFirebase(viagem);
    }

    form.reset();
  });

  ordenarBtn.addEventListener('click',()=>carregarViagensFirebase());
  filtroMes.addEventListener('change',()=>carregarViagensFirebase());

  carregarViagensFirebase();
</script>

</body>
</html>
